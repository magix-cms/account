var account=function($,window,document,undefined){"use strict";function initAlert(m,timeout,sub){sub=typeof sub!=="undefined"?sub:false;timeout=typeof timeout!=="undefined"?timeout:false;if(sub)$.jmRequest.notifier={cssClass:".mc-message-"+sub};$.jmRequest.initbox(m,{display:true});if(timeout)window.setTimeout((function(){$(".mc-message .alert").alert("close")}),timeout)}function subsFormDelete(f,controller){var options={handler:"submit",url:$(f).attr("action"),method:"post",form:$(f),resetForm:false,success:function(d){if(d.debug!==undefined&&d.debug!==""){initAlert(d.debug)}else if(d.notify!==undefined&&d.notify!==""){initAlert(d.notify,4e3)}}};options.resetForm=true;options.success=function(d){$("#delete_modal_subs").modal("hide");$.jmRequest.notifier={cssClass:".mc-message-"+controller};initAlert(d.notify,4e3);if(d.status&&d.result){if(typeof d.result.id==="string"||typeof d.result.id==="number"){let ids=0;if(typeof d.result.id==="string"){ids=d.result.id.split(",")}else if(typeof d.result.id==="number"){ids=[d.result.id]}let nbr=0;let table=$("#table-"+controller);let container=null;for(var i=0;i<ids.length;i++){container=$("#"+controller+"_"+ids[i]).parent();$("#"+controller+"_"+ids[i]).next(".collapse").remove();$("#"+controller+"_"+ids[i]).remove();if(table.is("table")){nbr=table.find("tbody").find("tr").length}else if(table.is("ul")&&!nbr){nbr=table.children("li").length}}container.trigger("change");if(table.is("table")&&!nbr){table.addClass("hide").next(".no-entry").removeClass("hide")}else if(table.is("ul")&&!nbr){table.next(".no-entry").removeClass("hide")}$(".nbr-"+controller).text(nbr)}else{console.log(d.result)}}};$.jmRequest(options)}return{run:function(){$("#google_recaptcha").on("change",(function(){if($(this).is(":checked")){$("#recaptcha").collapse("show");$("#recaptchaApiKey").rules("add",{required:true});$("#recaptchaSecret").rules("add",{required:true})}else{$("#recaptcha").collapse("hide");$("#recaptchaApiKey").rules("remove");$("#recaptchaSecret").rules("remove")}}))},runEdit:function(){$("#delete_form_subs").validate({ignore:[],onsubmit:true,event:"submit",submitHandler:function(f,e){e.preventDefault();subsFormDelete(f,"subs");return false}});$(".extend_modal_subs").each((function(){$(this).off().on("click",(function(e){e.preventDefault();var modal=$(this).data("target"),controller=$(this).data("controller"),id=$(this).data("id_subs")?$(this).data("id_subs"):false;if(modal&&id&&controller){$(modal+' input[type="hidden"]').val(id);$(modal).modal("show")}else{$("#error_modal").modal("show")}}))}))}}}(jQuery,window,document);